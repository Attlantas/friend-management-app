{"ast":null,"code":"import { io } from 'socket.io-client';\nimport { toast } from 'react-toastify';\nimport { WEBSOCKET_SERVER_URL } from '../constants';\nconst showNotification = (message, type = 'info') => {\n  toast[type](`üì© New friend request from ${request.username}`, {\n    position: 'top-right',\n    autoClose: 5000,\n    // Auto-hide after 5 seconds\n    hideProgressBar: false,\n    closeOnClick: true,\n    pauseOnHover: true,\n    draggable: true\n  });\n};\nexport const socket = io(WEBSOCKET_SERVER_URL, {\n  transports: ['websocket'],\n  reconnectionAttempts: 5,\n  reconnectionDelay: 3000\n  //withCredentials: true\n});\nexport const setupSocketListeners = (dispatch, userId) => {\n  if (!socket) return;\n  socket.on('connect', () => {\n    console.log('Connected to WebSocket ‚úÖ');\n    socket.emit('user_online', userId); // Inform server that user is online\n  });\n  socket.on('friend_request', request => {\n    console.log('New Friend Request üì©', request);\n    dispatch({\n      type: 'friends/addFriendRequest',\n      payload: request\n    });\n    toast.info(`üì© New friend request from ${request.username}`, {\n      position: 'top-right',\n      autoClose: 5000,\n      // Auto-hide after 5 seconds\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true\n    });\n  });\n  socket.on('friend_request_accepted', friend => {\n    console.log('Friend Added üéâ', friend);\n    dispatch({\n      type: 'friends/fetchFriendsSuccess',\n      payload: friend\n    });\n  });\n  socket.on('friend_removed', removedFriendId => {\n    console.log('Friend Removed ‚ùå', removedFriendId);\n    dispatch({\n      type: 'friends/removeFriendSuccess',\n      payload: removedFriendId\n    });\n  });\n  socket.on('disconnect', () => {\n    console.log('Disconnected from WebSocket ‚ùå');\n  });\n\n  // Emit `user_offline` when user closes the tab\n  window.addEventListener('beforeunload', () => {\n    if (userId) {\n      socket.emit('user_offline', userId);\n      console.log(`User ${userId} is offline (Tab Closed) ‚ùå`);\n    }\n  });\n};","map":{"version":3,"names":["io","toast","WEBSOCKET_SERVER_URL","showNotification","message","type","request","username","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","socket","transports","reconnectionAttempts","reconnectionDelay","setupSocketListeners","dispatch","userId","on","console","log","emit","payload","info","friend","removedFriendId","window","addEventListener"],"sources":["/Users/kthulu/PersonalDevelopment/friend-management-system/frontend/src/utils/socket.js"],"sourcesContent":["import { io } from 'socket.io-client';\nimport { toast } from 'react-toastify';\nimport {WEBSOCKET_SERVER_URL} from '../constants';\n\nconst showNotification = (message, type = 'info') => {\n  toast[type](`üì© New friend request from ${request.username}`, {\n    position: 'top-right',\n    autoClose: 5000, // Auto-hide after 5 seconds\n    hideProgressBar: false,\n    closeOnClick: true,\n    pauseOnHover: true,\n    draggable: true,\n  });\n}\n\nexport const socket = io(WEBSOCKET_SERVER_URL, {\n  transports: ['websocket'],\n  reconnectionAttempts: 5,\n  reconnectionDelay: 3000,\n  //withCredentials: true\n});\n\nexport const setupSocketListeners = (dispatch, userId) => {\n  if (!socket) return;\n\n  socket.on('connect', () => {\n    console.log('Connected to WebSocket ‚úÖ');\n    socket.emit('user_online', userId); // Inform server that user is online\n  });\n\n  socket.on('friend_request', (request) => {\n    console.log('New Friend Request üì©', request);\n    dispatch({type: 'friends/addFriendRequest', payload: request});\n\n    toast.info(`üì© New friend request from ${request.username}`, {\n      position: 'top-right',\n      autoClose: 5000, // Auto-hide after 5 seconds\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n    });\n  });\n\n  socket.on('friend_request_accepted', (friend) => {\n    console.log('Friend Added üéâ', friend);\n    dispatch({ type: 'friends/fetchFriendsSuccess', payload: friend });\n  });\n\n  socket.on('friend_removed', (removedFriendId) => {\n    console.log('Friend Removed ‚ùå', removedFriendId);\n    dispatch({ type: 'friends/removeFriendSuccess', payload: removedFriendId });\n  });\n\n  socket.on('disconnect', () => {\n    console.log('Disconnected from WebSocket ‚ùå');\n  });\n\n  // Emit `user_offline` when user closes the tab\n  window.addEventListener('beforeunload', () => {\n    if (userId) {\n      socket.emit('user_offline', userId);\n      console.log(`User ${userId} is offline (Tab Closed) ‚ùå`);\n    }\n  });\n};\n"],"mappings":"AAAA,SAASA,EAAE,QAAQ,kBAAkB;AACrC,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAAQC,oBAAoB,QAAO,cAAc;AAEjD,MAAMC,gBAAgB,GAAGA,CAACC,OAAO,EAAEC,IAAI,GAAG,MAAM,KAAK;EACnDJ,KAAK,CAACI,IAAI,CAAC,CAAC,8BAA8BC,OAAO,CAACC,QAAQ,EAAE,EAAE;IAC5DC,QAAQ,EAAE,WAAW;IACrBC,SAAS,EAAE,IAAI;IAAE;IACjBC,eAAe,EAAE,KAAK;IACtBC,YAAY,EAAE,IAAI;IAClBC,YAAY,EAAE,IAAI;IAClBC,SAAS,EAAE;EACb,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMC,MAAM,GAAGd,EAAE,CAACE,oBAAoB,EAAE;EAC7Ca,UAAU,EAAE,CAAC,WAAW,CAAC;EACzBC,oBAAoB,EAAE,CAAC;EACvBC,iBAAiB,EAAE;EACnB;AACF,CAAC,CAAC;AAEF,OAAO,MAAMC,oBAAoB,GAAGA,CAACC,QAAQ,EAAEC,MAAM,KAAK;EACxD,IAAI,CAACN,MAAM,EAAE;EAEbA,MAAM,CAACO,EAAE,CAAC,SAAS,EAAE,MAAM;IACzBC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IACvCT,MAAM,CAACU,IAAI,CAAC,aAAa,EAAEJ,MAAM,CAAC,CAAC,CAAC;EACtC,CAAC,CAAC;EAEFN,MAAM,CAACO,EAAE,CAAC,gBAAgB,EAAGf,OAAO,IAAK;IACvCgB,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEjB,OAAO,CAAC;IAC7Ca,QAAQ,CAAC;MAACd,IAAI,EAAE,0BAA0B;MAAEoB,OAAO,EAAEnB;IAAO,CAAC,CAAC;IAE9DL,KAAK,CAACyB,IAAI,CAAC,8BAA8BpB,OAAO,CAACC,QAAQ,EAAE,EAAE;MAC3DC,QAAQ,EAAE,WAAW;MACrBC,SAAS,EAAE,IAAI;MAAE;MACjBC,eAAe,EAAE,KAAK;MACtBC,YAAY,EAAE,IAAI;MAClBC,YAAY,EAAE,IAAI;MAClBC,SAAS,EAAE;IACb,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFC,MAAM,CAACO,EAAE,CAAC,yBAAyB,EAAGM,MAAM,IAAK;IAC/CL,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEI,MAAM,CAAC;IACtCR,QAAQ,CAAC;MAAEd,IAAI,EAAE,6BAA6B;MAAEoB,OAAO,EAAEE;IAAO,CAAC,CAAC;EACpE,CAAC,CAAC;EAEFb,MAAM,CAACO,EAAE,CAAC,gBAAgB,EAAGO,eAAe,IAAK;IAC/CN,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEK,eAAe,CAAC;IAChDT,QAAQ,CAAC;MAAEd,IAAI,EAAE,6BAA6B;MAAEoB,OAAO,EAAEG;IAAgB,CAAC,CAAC;EAC7E,CAAC,CAAC;EAEFd,MAAM,CAACO,EAAE,CAAC,YAAY,EAAE,MAAM;IAC5BC,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;EAC9C,CAAC,CAAC;;EAEF;EACAM,MAAM,CAACC,gBAAgB,CAAC,cAAc,EAAE,MAAM;IAC5C,IAAIV,MAAM,EAAE;MACVN,MAAM,CAACU,IAAI,CAAC,cAAc,EAAEJ,MAAM,CAAC;MACnCE,OAAO,CAACC,GAAG,CAAC,QAAQH,MAAM,4BAA4B,CAAC;IACzD;EACF,CAAC,CAAC;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}